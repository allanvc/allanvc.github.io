<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 3.2.0">
  <meta name="generator" content="Hugo 0.52" />
  <meta name="author" content="Allan V. C. Quadros">

  
  
  
  
    
  
  <meta name="description" content="This is an example of how to scrape Google News website with the awesome rvest package.
This work is the result of a question in our great discussion group R Dojo.
A user in the group came up with this problem and I decided to help him. It was a cool challenge, so why not?
I should advice you that a great deal of the basic ideas comes from his own code.">

  
  <link rel="alternate" hreflang="en-us" href="/post/web-scrap/2018-08-21-google_news_scraping/">

  


  

  

  

  

  

  

  
  
  
  <meta name="theme-color" content="#2962ff">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha256-eSi1q2PG6J7g7ib17yAaWMcrr5GrtohYChqibrV7PBE=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css" integrity="sha384-5sAR7xN1Nv6T6+dT2mhtzEpVJvfS3NScPQTrOxhwjIuvcA67KV2R5Jz6kr4abQsz" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atelier-cave-light.min.css" crossorigin="anonymous">
      
    

    

    

  

  
  
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:400,700|Merriweather|Roboto+Mono">
  

  <link rel="stylesheet" href="/styles.css">
  
  <link rel="stylesheet" href="/css/blue.css">
  

  
  
  

  
  <link rel="alternate" href="/index.xml" type="application/rss+xml" title="ALLAN V. C. QUADROS">
  <link rel="feed" href="/index.xml" type="application/rss+xml" title="ALLAN V. C. QUADROS">
  

  <link rel="manifest" href="/site.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="/post/web-scrap/2018-08-21-google_news_scraping/">

  
  
  
  
    
    
  
  <meta property="twitter:card" content="summary">
  
  <meta property="og:site_name" content="ALLAN V. C. QUADROS">
  <meta property="og:url" content="/post/web-scrap/2018-08-21-google_news_scraping/">
  <meta property="og:title" content="Scraping Google News with &#39;rvest&#39; | ALLAN V. C. QUADROS">
  <meta property="og:description" content="This is an example of how to scrape Google News website with the awesome rvest package.
This work is the result of a question in our great discussion group R Dojo.
A user in the group came up with this problem and I decided to help him. It was a cool challenge, so why not?
I should advice you that a great deal of the basic ideas comes from his own code."><meta property="og:image" content="/img/portrait.JPG">
  <meta property="og:locale" content="en-us">
  
  <meta property="article:published_time" content="2018-08-21T21:13:14-05:00">
  
  <meta property="article:modified_time" content="2018-08-21T21:13:14-05:00">
  

  

  

  <title>Scraping Google News with &#39;rvest&#39; | ALLAN V. C. QUADROS</title>

</head>
<body id="top" data-spy="scroll" data-target="#TableOfContents" data-offset="71" >
  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" role="textbox" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="/">ALLAN V. C. QUADROS</a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
        <span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">

      
      
      <ul class="navbar-nav ml-auto">
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/#about">
            
            <span>Home</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/#posts">
            
            <span>Posts</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/#projects">
            
            <span>Projects</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/#statsr">
            
            <span>Stats & R Misc.</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/tutorial/">
            
            <span>Courses</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/#contact">
            
            <span>Contact</span>
            
          </a>
        </li>

        
        

      

        

        
        <li class="nav-item">
          <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        

        

      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1 itemprop="name">Scraping Google News with &#39;rvest&#39;</h1>

  

  
    

<div class="article-metadata">

  
  
  <span itemscope itemprop="author" itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Allan V. C. Quadros">
  </span>
  

  <span class="article-date">
    
    <meta content="2018-08-21 21:13:14 -0500 -0500" itemprop="datePublished">
    <time datetime="2018-08-21 21:13:14 -0500 -0500" itemprop="dateModified">
      Aug 21, 2018
    </time>
  </span>
  <span itemscope itemprop="publisher" itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Allan V. C. Quadros">
  </span>

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    5 min read
  </span>
  

  
  

  
  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder"></i>
    
    <a href="/categories/r/">R</a>
    
  </span>
  
  

  
  
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=Scraping%20Google%20News%20with%20%27rvest%27&amp;url=%2fpost%2fweb-scrap%2f2018-08-21-google_news_scraping%2f"
         target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=%2fpost%2fweb-scrap%2f2018-08-21-google_news_scraping%2f"
         target="_blank" rel="noopener">
        <i class="fab fa-facebook-f"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2fpost%2fweb-scrap%2f2018-08-21-google_news_scraping%2f&amp;title=Scraping%20Google%20News%20with%20%27rvest%27"
         target="_blank" rel="noopener">
        <i class="fab fa-linkedin-in"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=%2fpost%2fweb-scrap%2f2018-08-21-google_news_scraping%2f&amp;title=Scraping%20Google%20News%20with%20%27rvest%27"
         target="_blank" rel="noopener">
        <i class="fab fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=Scraping%20Google%20News%20with%20%27rvest%27&amp;body=%2fpost%2fweb-scrap%2f2018-08-21-google_news_scraping%2f">
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>

    















  
</div>



  <div class="article-container">

    <div class="article-style" itemprop="articleBody">
      


<p>This is an example of how to scrape Google News website with the awesome <code>rvest</code> package.</p>
<p>This work is the result of a question in our great discussion group <a href="https://therdojo.wordpress.com" target="_blank"><strong>R Dojo</strong></a>.</p>
<p>A user in the group came up with this problem and I decided to help him. It was a cool challenge, so why not?</p>
<p>I should advice you that a great deal of the basic ideas comes from his own code. I just kept it and added few things in order to get the code working.</p>
<p>First off, you should take a look at the Google News (or Google Notícias) website <a href="https://news.google.com/?hl=pt-BR&amp;gl=BR&amp;ceid=BR:pt-419" target="_blank">HERE</a> which I reproduce below:</p>
<!-- ![](/post/web-scrap/![](/web-scrap/2018-08-21-google_news_scraping_files/google_news_screenshot.png)2018-08-21-google_news_scraping_files/google_news_screenshot.png) -->
<div class="figure">
<img src="/post/web-scrap/2018-08-21-google_news_scraping_files/google_news_screenshot.png" />

</div>
<hr />
<p>You may notice in the right side of the page we are using the Google Chrome <strong>dev-tools</strong> in order to detect all the <em>html nodes</em>. You can access this tool by hitting the <strong>F12</strong> key. The html nodes are passed as arguments into the <code>rvest</code> functions.</p>
<p>Basically, the idea is to extract the communication vehicle (vehicle), the time elapsed since the news was published (time), and the main headline (headline).</p>
<p>The code and coments are presented below:</p>
<pre class="r"><code># loading the packages:
library(dplyr) # we want the pipes
library(rvest) # webscrapping
library(stringr) # to deal with strings and to clean up our data</code></pre>
<pre class="r"><code># extracting the whole website
google &lt;- read_html(&quot;https://news.google.com/?hl=pt-BR&amp;gl=BR&amp;ceid=BR:pt-419&quot;)</code></pre>
<pre class="r"><code># extracting the com vehicles
# we pass the nodes in html_nodes and extract the text from the last one 
# we use stringr to delete strings that do not matter
vehicle_all &lt;- google %&gt;% html_nodes(&quot;div div div main c-wiz div div div article div div div&quot;) %&gt;% html_text() %&gt;%
  str_subset(&quot;[^more_vert]&quot;) %&gt;%
  str_subset(&quot;[^share]&quot;) %&gt;%
  str_subset(&quot;[^bookmark_border]&quot;)

vehicle_all[1:10] # take a look at the first ten</code></pre>
<pre><code>##  [1] &quot;G1&quot;                     &quot;UOL&quot;                   
##  [3] &quot;Brasil 247&quot;             &quot;Jornal O Globo&quot;        
##  [5] &quot;InfoMoney&quot;              &quot;Folha de S.Paulo&quot;      
##  [7] &quot;G1&quot;                     &quot;Estadão&quot;               
##  [9] &quot;Jornal Cruzeiro do Sul&quot; &quot;UOL&quot;</code></pre>
<pre class="r"><code># extracting the time elapsed
time_all &lt;- google %&gt;% html_nodes(&quot;div article div div time&quot;) %&gt;% html_text()

time_all[1:10] # take a look at the first ten</code></pre>
<pre><code>##  [1] &quot;hoje&quot;          &quot;ontem&quot;         &quot;hoje&quot;          &quot;hoje&quot;         
##  [5] &quot;hoje&quot;          &quot;5 horas atrás&quot; &quot;hoje&quot;          &quot;4 horas atrás&quot;
##  [9] &quot;2 horas atrás&quot; &quot;5 horas atrás&quot;</code></pre>
<pre class="r"><code># extracting the headlines
# and using stringr for cleaning
headline_all &lt;- google %&gt;% html_nodes(&quot;article&quot;) %&gt;% html_text(&quot;span&quot;) %&gt;%
  str_split(&quot;(?&lt;=[a-z0-9áéó!?])(?=[A-Z])&quot;) # also considering portuguese special characters

headline_all &lt;- sapply(headline_all, function(x) x[1]) # extract only the first elements


headline_all[1:10] # take a look at the first ten</code></pre>
<pre><code>##  [1] &quot;Congresso começa a votar Previdência &#39;com toda certeza&#39; em 6 meses, diz Bolsonaro&quot;                                                                                                                                                                                      
##  [2] &quot;É forte a tendência de a reforma da Previdência ser fatiada, diz Bolsonaro&quot;                                                                                                                                                                                             
##  [3] &quot;Miriam Leitão diz que &#39;fatiar&#39; reforma da previdência é um erro247 - A jornalista Miriam Leitão afirma que fatiar a reforma da previdência é um erro. Ela diz: \&quot;a reforma não matará idoso, ao contrário do que disse o ...Brasil 247hojebookmark_bordersharemore_vert&quot;
##  [4] &quot;A reforma não pode esperar&quot;                                                                                                                                                                                                                                             
##  [5] &quot;Dividir para conquistar? Fatiamento da Previdência pode dificultar caminho da aprovação&quot;                                                                                                                                                                                
##  [6] &quot;Câmara aprova fim de punição para municípios que estourarem limite de gasto com pessoal&quot;                                                                                                                                                                                
##  [7] &quot;Câmara aprova permissão para municípios estourarem limite de gastos com pessoal&quot;                                                                                                                                                                                        
##  [8] &quot;Câmara libera gastos com pessoal em municípios&quot;                                                                                                                                                                                                                         
##  [9] &quot;Deputados autorizam municípios a gastarem mais com pessoal&quot;                                                                                                                                                                                                             
## [10] &quot;Câmara aprova projeto que permite a municípios estourarem limite de gastos com pessoal&quot;</code></pre>
<p>In this last case we used a regular expression (REGEX) to clean up the data. We did this by separating the actual headline phrases from the complementary phrases. In some cases we have a phrase ending in uppercase letters such as “SP” collapsed with other phrase initiating with another uppercase letter such as “A” for example. We have to think of a better way to split these cases, but the current result is quite satisfactory for now.</p>
<p>Before we finish, we have to clean up our data. It is common to colect garbage such as data related to “fake news verification”&quot; aside the page (in the Brazilian page). So, the three vectors we create may have different sizes. We use the smallest of them as the base and just delete the entries above this number.</p>
<pre class="r"><code># finding the smallest vector
min &lt;- min(sapply(list(vehicle_all, time_all, headline_all), length))

# cutting
vehicle_all &lt;- vehicle_all[1:min]
time_all &lt;- time_all[1:min]
headline_all &lt;- headline_all[1:min]</code></pre>
<p>And we have our final data frame:</p>
<pre class="r"><code>df_news &lt;- data_frame(vehicle_all, time_all, headline_all)

df_news</code></pre>
<pre><code>## # A tibble: 139 x 3
##    vehicle_all       time_all   headline_all                              
##    &lt;chr&gt;             &lt;chr&gt;      &lt;chr&gt;                                     
##  1 G1                hoje       Congresso começa a votar Previdência &#39;com…
##  2 UOL               ontem      É forte a tendência de a reforma da Previ…
##  3 Brasil 247        hoje       &quot;Miriam Leitão diz que &#39;fatiar&#39; reforma d…
##  4 Jornal O Globo    hoje       A reforma não pode esperar                
##  5 InfoMoney         hoje       Dividir para conquistar? Fatiamento da Pr…
##  6 Folha de S.Paulo  5 horas a… Câmara aprova fim de punição para municíp…
##  7 G1                hoje       Câmara aprova permissão para municípios e…
##  8 Estadão           4 horas a… Câmara libera gastos com pessoal em munic…
##  9 Jornal Cruzeiro … 2 horas a… Deputados autorizam municípios a gastarem…
## 10 UOL               5 horas a… Câmara aprova projeto que permite a munic…
## # ... with 129 more rows</code></pre>
<hr />
<hr />

    </div>

    


<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/rvest/">rvest</a>
  
  <a class="badge badge-light" href="/tags/web-scraping/">web scraping</a>
  
  <a class="badge badge-light" href="/tags/googlenews/">GoogleNews</a>
  
</div>



    






<div class="media author-card" itemscope itemtype="http://schema.org/Person">
  
  <img class="portrait mr-3" src="/img/portrait.JPG" itemprop="image" alt="Avatar">
  
  <div class="media-body">
    <h5 class="card-title" itemprop="name"><a href="/">Allan V. C. Quadros</a></h5>
    <h6 class="card-subtitle">Statistician</h6>
    
    <ul class="network-icon" aria-hidden="true">
      
      
      
      
        
      
      
      
      
      
      <li>
        <a itemprop="sameAs" href="mailto:allanvcq@gmail.com" >
          <i class="fas fa-envelope"></i>
        </a>
      </li>
      
      
      
      
        
      
      
      
      
      
        
      
      <li>
        <a itemprop="sameAs" href="https://github.com/allanvc" target="_blank" rel="noopener">
          <i class="fab fa-github"></i>
        </a>
      </li>
      
      
      
      
      
      
      
      
        
      
      <li>
        <a itemprop="sameAs" href="/files/allanvcq_CV2.pdf" >
          <i class="ai ai-cv"></i>
        </a>
      </li>
      
      
      
      
        
      
      
      
      
      
        
      
      <li>
        <a itemprop="sameAs" href="https://www.linkedin.com/in/allan-vieira/" target="_blank" rel="noopener">
          <i class="fab fa-linkedin"></i>
        </a>
      </li>
      
    </ul>
  </div>
</div>




    
    

    

    


  </div>
</article>

<div class="container">
  <footer class="site-footer">
  
  <p class="powered-by">
    <a href="/privacy/">Privacy Policy</a>
  </p>
  

  <p class="powered-by">
    &copy; 2018 Allan V. C. Quadros &middot; 

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" id="back_to_top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

</div>


<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

    

    
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha512-+NqPlbbtM1QqiK8ZAo4Yrj2c4lNQoGv8P79DPtKzj++l5jnN39rHA/xsqn8zE9l0uSoxaCdrOgFs6yjyfbBxSg==" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.3/imagesloaded.pkgd.min.js" integrity="sha512-umsR78NN0D23AzgoZ11K7raBD+R6hqKojyBZs1w8WvYlsI+QuKRGBx3LFCwhatzBunCjDuJpDHwxD13sLMbpRA==" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha256-VsEqElsCHSGmnmHXGQzvoWjWwoznFSZc6hs7ARLRacQ=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
        
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/r.min.js"></script>
        
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
        
      

      
      
    

    
    

    
    
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script>
      const search_index_filename = "/index.json";
      const i18n = {
        'placeholder': "Search...",
        'results': "results found",
        'no_results': "No results found"
      };
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    
    
    
    
    
    
    
    <script src="/js/academic.min.d037ee5294b166a79dec317c58aea9cc.js"></script>

    

  </body>
</html>

